<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-02-15
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160215" />
    <meta http-equiv="Content-Language" content="en" />
    <title>YADA Documentation - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>YADA</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2016-02-15</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 6.2.4-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Getting Started</li>
                                
      <li>
    
                          <a href="index.html" title="ReadMe">
          <i class="none"></i>
        ReadMe</a>
            </li>
                  
      <li>
    
                          <a href="deployment.html" title="Quickstart/Deployment Guide">
          <i class="none"></i>
        Quickstart/Deployment Guide</a>
            </li>
                              <li class="nav-header">Advanced Documentation</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>Admin Guide for Query Authors</a>
          </li>
                  
      <li>
    
                          <a href="guide.html" title="User/Developer Guide">
          <i class="none"></i>
        User/Developer Guide</a>
            </li>
                  
      <li>
    
                          <a href="pluginguide.html" title="Plugin Guide">
          <i class="none"></i>
        Plugin Guide</a>
            </li>
                  
      <li>
    
                          <a href="testing.html" title="Testing Notes">
          <i class="none"></i>
        Testing Notes</a>
            </li>
                              <li class="nav-header">Feature Specifications</li>
                                
      <li>
    
                          <a href="yada-api/apidocs/index.html" title="JavaDoc">
          <i class="none"></i>
        JavaDoc</a>
            </li>
                  
      <li>
    
                          <a href="yada-api/testapidocs/index.html" title="Test JavaDoc">
          <i class="none"></i>
        Test JavaDoc</a>
            </li>
                  
      <li>
    
                          <a href="uml.html" title="Java Visual Reference">
          <i class="none"></i>
        Java Visual Reference</a>
            </li>
                  
      <li>
    
                          <a href="params.html" title="YADA Parameters Reference">
          <i class="none"></i>
        YADA Parameters Reference</a>
            </li>
                  
      <li>
    
                          <a href="jsonparams.html" title="JSONParams Specification">
          <i class="none"></i>
        JSONParams Specification</a>
            </li>
                  
      <li>
    
                          <a href="filters.html" title="Filters Specification">
          <i class="none"></i>
        Filters Specification</a>
            </li>
                  
      <li>
    
                          <a href="harmony.html" title="Harmonizer Specification">
          <i class="none"></i>
        Harmonizer Specification</a>
            </li>
                  
      <li>
    
                          <a href="mail.html" title="Mail Specification">
          <i class="none"></i>
        Mail Specification</a>
            </li>
                              <li class="nav-header">Project License</li>
                                
      <li>
    
                          <a href="LICENSE.txt" title="Apache License v2.0">
          <i class="none"></i>
        Apache License v2.0</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                                                
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Admin Guide for Query Authors</h1>

    <div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><img src="images/blox250.png" alt="" /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>


<blockquote>
<p>NOTE: The term <tt>YADA app</tt> is effectively synonymous with <tt>YADA datasource</tt></p>
</blockquote>
<div class="section">
<h2>Installed and Oriented?<a name="Installed_and_Oriented"></a></h2>
<p>See the <a href="deployment.html">Quickstart/Deployment Guide</a> if you&#x2019;ve not yet installed YADA on a server somewhere.<br />See the <a href="guide.html">User Guide</a> if you&#x2019;re not sure what you&#x2019;re going to do with admin tool.</p></div>
<div class="section">
<h2>Where is yada-admin?<a name="Where_is_yada-admin"></a></h2>
<p>YADA ships with a webapp called <b>yada-admin</b>. It should be accessible after install at your <tt>YADA context/yada-admin</tt> url. For example, if you installed the quickstart app version 6.0.0 on your localhost in a default tomcat config (port 8080,) the yada-admin app would be accessible at</p>

<div class="source">
<pre>http://localhost:8080/YADA-Quickstart-6.0.0/yada-admin
</pre></div></div>
<div class="section">
<h2>Using yada-admin<a name="Using_yada-admin"></a></h2>
<p><b>yada-admin</b> enables the following activity:</p>

<ol style="list-style-type: decimal">
  
<li>Create new JDBC, SOAP, REST, or FILE queries for configured YADA apps using the syntax-coloring-enabled editor from <a class="externalLink" href="https://codemirror.net/">CodeMirror</a></li>
  
<li>Modify existing queries</li>
  
<li>Delete existing queries</li>
  
<li>Assign new default YADA parameters with values for existing queries</li>
  
<li>Modify default YADA parameters and values</li>
  
<li>Delete default YADA parameters</li>
  
<li>Update in-memory cache with new query versions and configuration automatically</li>
  
<li>Switch between YADA apps</li>
  
<li>Toggle query format from monospace and pre-formatted to proportional and fluid (useful for large queries which consume your whole screen.)</li>
  
<li>Filter query list on <tt>qname</tt> and <tt>query</tt> content to more easily find the queries for which you&#x2019;re looking</li>
  
<li>Sort the query list</li>
  
<li>Migrate queries and associated default YADA parameters from one YADA index to another, e.g., DEV to TEST, or TEST to PROD.</li>
  
<li>View diffs of query and default YADA parameter versions between different YADA indices, e.g., DEV and TEST</li>
</ol>
<div class="section">
<h3>YADA Markup Refresher<a name="YADA_Markup_Refresher"></a></h3>
<p>As elucidated in the <a href="guide.html">User GUide</a>, for authoring queries, use the following markup for parameter symbols:</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="center">Markup</th>
      
<th align="left">Definition </th>
      
<th align="left">Description </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="center">?v </td>
      
<td align="left">VARCHAR, VARCHAR2, CHAR</td>
      
<td align="left">Any character-based data type</td>
    </tr>
    
<tr class="a">
      
<td align="center">?i </td>
      
<td align="left">INTEGER, INT </td>
      
<td align="left">Any integer data type </td>
    </tr>
    
<tr class="b">
      
<td align="center">?n </td>
      
<td align="left">NUMBER, DECIMAL </td>
      
<td align="left">Any floating point data type </td>
    </tr>
    
<tr class="a">
      
<td align="center">?d </td>
      
<td align="left">DATE </td>
      
<td align="left">Any date data type </td>
    </tr>
    
<tr class="b">
      
<td align="center">?t </td>
      
<td align="left">TIME </td>
      
<td align="left">Any time data type </td>
    </tr>
  </tbody>
</table></div></div>
<div class="section">
<h2>The UI<a name="The_UI"></a></h2>
<p>It looks like this (hopefully, most of the time:)</p>
<p><img src="images/ui-ui.png" alt="ui" /></p>
<div class="section">
<h3>Toolbar<a name="Toolbar"></a></h3>
<p>The application menubar enables you to switch apps, create a query, toggle the query code format, or migrate queries from one YADA index to another.</p>
<p><img src="images/ui-toolbar.png" width="410" height="60" alt="" /></p></div></div>
<div class="section">
<h2>Apps<a name="Apps"></a></h2>
<div class="section">
<h3>Switching<a name="Switching"></a></h3>
<p>To switch between apps, click the <tt>Choose App</tt> button:</p>
<p><img src="images/ui-choose-app.png" width="100" height="50" alt="" /></p>
<p>The dialog will appear with an auto-complete dropdown. Click or Down-arrow/Enter on your app of interest.</p>
<p><img src="images/ui-choose-app-menu.png" width="400" height="250" alt="" /></p></div></div>
<div class="section">
<h2>Queries<a name="Queries"></a></h2>
<p>Any changes to queries made in the <tt>yada-admin</tt> tool result in updating of the in-memory <a class="externalLink" href="http://www.ehcache.org/">ehcache</a>, via the <a class="externalLink" href="http://opensource.nibr.com/YADA/yada-api/apidocs/com/novartis/opensource/yada/plugin/CachedQueryUpdater.html">CachedQueryUpdater</a> post-processor plugin (see the <a href="pluginguide.html">Plugin Guide</a>.)</p>

<blockquote>
<p>Note that queries which are updated directly in the YADA Index using a command-line or GUI tool other than yada-admin, do not refresh in the cache automatically, which can result in confusion. If you do edit queries directly, it is recommend to run the <a class="externalLink" href="http://opensource.nibr.com/YADA/yada-api/apidocs/com/novartis/opensource/yada/plugin/CachedUpdater.html">CacheUpdater</a> plugin via your web browser, or curl command. </p>
  
<div class="source">
<pre>http://localhost:8080/YADA-Quickstart-6.0.0/yada.jsp?q=YADA default&amp;pl=CacheUpdater
</pre></div>
</blockquote>
<div class="section">
<h3>Creating<a name="Creating"></a></h3>
<p>To create a query, make sure the app to which the query pertains is active, the click the <tt>New Query</tt> button:</p>
<p><img src="images/ui-new-query-btn.png" width="100" height="50" alt="" /></p>
<p>The <tt>Edit Query</tt> dialog will pop up:</p>
<p><img src="images/ui-new-query.png" width="600" height="330" alt="" /></p>
<p>Enter the query name in the <tt>Qname</tt> field. It is not required, but it is <b>HIGHLY RECOMMENDED</b> to preface the query name with the app code, e.g., <tt>MYAPP insert gumbo</tt> or <tt>MYAPP select fnords</tt></p>
<p>Then just type your code with appropriate YADA markup in code box, and click Save.</p>
<p>YADA will inform you with a confirmation that the query was saved.</p></div>
<div class="section">
<h3>Modifying<a name="Modifying"></a></h3>
<p>To modify a query, click on the row containing the query you wish to edit. The <tt>Edit Query</tt> dialog will appear again, pre-populated, as well as with the Default Parameter options (see below.)</p>
<p><img src="images/ui-mod-query.png" width="600" height="340" alt="" /></p>
<p>Remember to click <tt>Save</tt> after making your changes.</p>
<p>YADA will inform you with a confirmation that your changes were saved.</p></div>
<div class="section">
<h3>Deleting<a name="Deleting"></a></h3>
<p>To delete a query, click on the row containing the query you wish to edit. The <tt>Edit query</tt> dialog will again appear. Click the <tt>Delete</tt> button, and then confirm your intention to delete.</p>
<p>YADA will inform you with a confirmation that the query was deleted. This is currently an irreversible process. Once you&#x2019;ve deleted a query, it&#x2019;s gone.</p></div>
<div class="section">
<h3>Filtering<a name="Filtering"></a></h3>
<p>To filter the visible queries in the queries list by any string in the <tt>qname</tt> or <tt>query</tt> column, just type it in the filter box. The found set of queries will reduce instantly.</p>
<p><img src="images/ui-filters.png" width="300" height="70" alt="" /></p></div></div>
<div class="section">
<h2>Default YADA Parameters<a name="Default_YADA_Parameters"></a></h2>
<p>Technically, YADA queries will not execute without some &#x201c;default&#x201d; parameters such as <tt>JSONParams</tt> or in its absence, <tt>qname</tt>. Some YADA parameters have default values, like <tt>format</tt>, which is automatically set to <tt>json</tt> unless set explicitly to something else (see the <a href="params.html">YADA Parameter Specification</a> for details.) Outside of these defaults, no YADA queries have explicit default parameters.</p>
<p>A default YADA parameter is tantamount to hardcoding a parameter and static value in a YADA request; to include it every time that query is requested. Some use cases for default YADA parameters include:</p>

<ul>
  
<li><b>Security</b>: include the <tt>cookie</tt> or <tt>ck</tt> parameter to ensure that every time your REST query executes, your authentication cookie is passed through to the target service.</li>
  
<li><b>Compatibility</b>: Some JDBC-compatible datasources do not support open cursors after commit, causing errors to be thrown unless the default <tt>count=true</tt> or <tt>c=true</tt> is explicity changed to false. Storing this as a default YADA parameter takes the headache out of usage.</li>
  
<li><b>Convenience</b>: It saves you the trouble of including a specific parameter everywhere you use the specified query. For example, if you always want an entire result set, rather than a paginated one, use <tt>pz=-1</tt> in the URL <i>every time</i>, or better, set it as a default YADA param in the admin tool.</li>
</ul>
<div class="section">
<h3>Creating<a name="Creating"></a></h3>
<p>To add a default YADA parameter to a query, start typing in the <tt>Parameter</tt> input box. An auto-suggest menu will appear. If you don&#x2019;t know what a particular parameter means, roll over the menu item to see the popup hint. Click on it to select it.</p>
<p><img src="images/ui-param-hint.png" width="600" height="330" alt="" /></p>
<p>Note that some YADA parameters expect boolean values, some integers, etc. The <tt>Value</tt> input control should change based on your selection and validate your input as well.</p>
<p>&#x2013;</p>
<div class="section">
<h4>Mutability or Overridablity<a name="Mutability_or_Overridablity"></a></h4>
<p>Some parameters set by default should not be overridable by re-setting them in a request&#x2019;s URL string or POST content. Think security, for example. If you want to execute a security preprocessor plugin before your query is executed, it wouldn&#x2019;t be too helpful to allow a developer to circumvent the default plugin execution. Choosing <tt>non-overridable</tt> (the default) will prohibit modification of the setting.</p>
<p>&#x2013;</p>
<p>To save the new default YADA parameter, click the disk icon. To add another, click the plus icon.</p>
<p>Don&#x2019;t forget to click the <tt>Save</tt> button for the dialog as well.</p></div></div>
<div class="section">
<h3>Modifying<a name="Modifying"></a></h3>
<p>Any default YADA parameter can be modified in the same manner as creating. Don&#x2019;t forget to click the <tt>Save</tt> button for the dialog as well.</p></div>
<div class="section">
<h3>Deleting<a name="Deleting"></a></h3>
<p>To delete a default YADA parameter click the red X next to the parameter you wish to delete. Don&#x2019;t forget to click the <tt>Save</tt> button for the dialog as well.</p></div></div>
<div class="section">
<h2>Toggle View<a name="Toggle_View"></a></h2>
<p><img src="images/ui-toggle-view.png" width="100" height="60" alt="" /></p>
<p>Just try it. It changes the format of the <tt>Query</tt> column from monospaced, syntax-aware, pre-formatted html to proportional font with fluid text. This is basically just to facilitate seeing more rows in the table vs seeing more detail in your code.</p></div>
<div class="section">
<h2>Migrating<a name="Migrating"></a></h2>
<p>Migration is a bit more involved. </p>
<p>Migration effectively means copying selected queries from one YADA index to another. There are a few prerequisites:</p>

<ol style="list-style-type: decimal">
  
<li>The source and target YADA indices should both be at same framework version.</li>
  
<li>The target YADA index host must be configured in the source host&#x2019;s <tt>yada-admin/config.json</tt> file. This is what enables it to appear in the migration dialog drop-down menu.</li>
  
<li>The app selected for migration must be configured in both YADA indices.</li>
  
<li>There must be discrepancies in the query code and/or default parameters between the two YADA indices for any queries to appear in the diff tool.</li>
  
<li><a class="externalLink" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">Cross-Origin Resource Sharing</a> (CORS) can pose a problem with migration, because the transfer is performed by browser-based YADA requests to the target system, whereas the admin-tool is hosted on the source system. The <a href="deployment.html">Quickstart/Deployment Guide</a> has some tips for overcoming this.</li>
</ol>
<p>To begin migration, click the <tt>Migrate</tt> button in the toolbar.</p>
<p><img src="images/ui-migrate.png" width="100" height="60" alt="" /></p>
<p>A modal popup with autosuggest will appear. Start typing the name of the target YADA index, e.g., test.</p>
<p><img src="images/ui-migrate-target.png" width="300" height="180" alt="" /></p>
<p>Select your target of choice. The yada-admin migration diff table will appear:</p>
<p><img src="images/ui-migrate-diff.png" alt="" /></p>
<p>There are a few things to note:</p>

<ul>
  
<li>Queries in the source YADA index appear on the right side. Queries in the target YADA index appear on the left side. The <a class="externalLink" href="http://www.mergely.com/">Mergely</a> javascript diff tool is used for the diff table, and it inverts the highlighting when ordering the columns the other way. This column order, target-&gt;source seems off at first, but the inverted highlighting was just wrong. If it makes more sense to do so, think of the table as showing the the target is changing FROM the left hand content TO the right hand content.</li>
  
<li>Only queries which differ by content, or parameter settings will appear in the table.</li>
  
<li>Only queries which are have a more recent modification time in the source YADA index than in the target YADA index will be selected for migration by default in the first column. All queries in the table are selectable but not all are selected by default.</li>
  
<li>Queries that exist only in the source YADA index will appear entirely highlighted, and their counterparts in the target will be empty.</li>
  
<li>Only queries selected in the first column will be migrated.</li>
  
<li>Queries that have different default YADA parameters will also deplay the parameter differences (see the <tt>YADA default</tt> query in the image.)</li>
</ul>
<p>Once you&#x2019;ve selected the queries you wish to transfer, click the <tt>Migrate</tt> button in the bottom right below the table.</p>
<p><img src="images/ui-migrate-exec.png" width="100" height="60" alt="" /></p>
<p>The UI will refresh. If you selected all the rows of the table, indicated there are no more queries to migrate. If you selected only some of the rows, only those previously unselected should appear.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2016
                        <a href="http://opensource.nibr.com">Novartis Institutes for BioMedical Research, Inc</a>.
                  
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
