<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-02-15
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160215" />
    <meta http-equiv="Content-Language" content="en" />
    <title>YADA Documentation - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>YADA</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2016-02-15</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 6.2.4-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Getting Started</li>
                                
      <li>
    
                          <a href="index.html" title="ReadMe">
          <i class="none"></i>
        ReadMe</a>
            </li>
                  
      <li>
    
                          <a href="deployment.html" title="Quickstart/Deployment Guide">
          <i class="none"></i>
        Quickstart/Deployment Guide</a>
            </li>
                              <li class="nav-header">Advanced Documentation</li>
                                
      <li>
    
                          <a href="admin.html" title="Admin Guide for Query Authors">
          <i class="none"></i>
        Admin Guide for Query Authors</a>
            </li>
                  
      <li>
    
                          <a href="guide.html" title="User/Developer Guide">
          <i class="none"></i>
        User/Developer Guide</a>
            </li>
                  
      <li>
    
                          <a href="pluginguide.html" title="Plugin Guide">
          <i class="none"></i>
        Plugin Guide</a>
            </li>
                  
      <li>
    
                          <a href="testing.html" title="Testing Notes">
          <i class="none"></i>
        Testing Notes</a>
            </li>
                              <li class="nav-header">Feature Specifications</li>
                                
      <li>
    
                          <a href="yada-api/apidocs/index.html" title="JavaDoc">
          <i class="none"></i>
        JavaDoc</a>
            </li>
                  
      <li>
    
                          <a href="yada-api/testapidocs/index.html" title="Test JavaDoc">
          <i class="none"></i>
        Test JavaDoc</a>
            </li>
                  
      <li>
    
                          <a href="uml.html" title="Java Visual Reference">
          <i class="none"></i>
        Java Visual Reference</a>
            </li>
                  
      <li>
    
                          <a href="params.html" title="YADA Parameters Reference">
          <i class="none"></i>
        YADA Parameters Reference</a>
            </li>
                  
      <li>
    
                          <a href="jsonparams.html" title="JSONParams Specification">
          <i class="none"></i>
        JSONParams Specification</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Filters Specification</a>
          </li>
                  
      <li>
    
                          <a href="harmony.html" title="Harmonizer Specification">
          <i class="none"></i>
        Harmonizer Specification</a>
            </li>
                  
      <li>
    
                          <a href="mail.html" title="Mail Specification">
          <i class="none"></i>
        Mail Specification</a>
            </li>
                              <li class="nav-header">Project License</li>
                                
      <li>
    
                          <a href="LICENSE.txt" title="Apache License v2.0">
          <i class="none"></i>
        Apache License v2.0</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                                                
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Filter Specification</h1>

    <div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><div style="float:right;margin-top:-43px;"><img src="images/blox250.png" alt="" /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>

<p>Filters are deep and versatile. All manner of boolean grouping and operations are supported, with only a few exceptions. </p>
<p>Due to the use of square brackets <tt>[</tt> and <tt>]</tt> in JSON notation, parentheses <tt>(</tt> and <tt>)</tt> are used to denote optional content.</p>
<div class="section">
<div class="section">
<h3>filter<a name="filter"></a></h3>
<p>The filter object is a JSON object containing two or three keys. </p>

<div class="source">
<pre>{ 
  &quot;groupOp&quot;: groupOperator,
  &quot;rules&quot;  : rules
  (&quot;groups&quot; : groups)
}
</pre></div></div>
<div class="section">
<h3>groupOperator<a name="groupOperator"></a></h3>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="left">Key</th>
      
<th align="left">Accepted Values</th>
      
<th align="left">Description</th>
      
<th align="left">Notes</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="left"><tt>groupOp</tt></td>
      
<td align="left"><tt>AND</tt><br /><tt>OR</tt></td>
      
<td align="left">applies to all rules at the current level and the nested groups as a whole</td>
      
<td align="left"> </td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h3>rules<a name="rules"></a></h3>
<p>A json array defining your criteria in rule objects. Again, parentheses, <tt>(</tt> and <tt>)</tt> denote optional content.</p>

<div class="source">
<pre>[ rule (, rule) ]
</pre></div></div>
<div class="section">
<h3>groups<a name="groups"></a></h3>
<p>An optional json array containing nested filter objects, theoretically enabling infinite nesting of filters. Again, parentheses, <tt>(</tt> and <tt>)</tt> denote optional content.</p>

<div class="source">
<pre>[ filter (,filter) ]
</pre></div></div>
<div class="section">
<h3>rule<a name="rule"></a></h3>
<p>A json object defining a single criterion for filtering. Again, parentheses, <tt>(</tt> and <tt>)</tt> denote optional content.</p>

<div class="source">
<pre>{ 
  &quot;field&quot; : field,
  &quot;op&quot;    : fieldOperator,
  &quot;data&quot;  : data
  (, &quot;type&quot;  : type)
}
</pre></div></div>
<div class="section">
<h3>field<a name="field"></a></h3>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="left">Key</th>
      
<th align="left">Accepted Values</th>
      
<th align="left">Description</th>
      
<th align="left">Notes</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="left"><tt>field</tt></td>
      
<td align="left">a string</td>
      
<td align="left">the value must correspond to the fields in query referenced by qname </td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h3>fieldOperator<a name="fieldOperator"></a></h3>
<p>The comparison operator defining how to evaluate the field/value relationship</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="left">Key</th>
      
<th align="left">Accepted Values</th>
      
<th align="left">Description</th>
      
<th align="left">Notes</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="left"><tt>op</tt></td>
      
<td align="left"><tt>eq</tt></td>
      
<td align="left">equals</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>ne</tt></td>
      
<td align="left">not equals</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>lt</tt></td>
      
<td align="left">less than</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>le</tt></td>
      
<td align="left">less than or equal to</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>gt</tt></td>
      
<td align="left">greater than</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>ge</tt></td>
      
<td align="left">greater than or equal to</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>in</tt></td>
      
<td align="left">in</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>ni</tt></td>
      
<td align="left">not in</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>nu</tt></td>
      
<td align="left">null</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>nn</tt></td>
      
<td align="left">not null</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>bw</tt></td>
      
<td align="left">begins with</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>bn</tt></td>
      
<td align="left">does not begin with</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>ew</tt></td>
      
<td align="left">ends with</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>en</tt></td>
      
<td align="left">does not end with</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>cn</tt></td>
      
<td align="left">contains</td>
      
<td align="left"> </td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>nc</tt></td>
      
<td align="left">does not contain</td>
      
<td align="left"> </td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h3>data<a name="data"></a></h3>
<p>The value to use in the comparison operation. Effectively any string, integer, decimal, or date.</p></div>
<div class="section">
<h3>type<a name="type"></a></h3>
<p>An optional classifier to clarify what type of operator can be used when building the filtering code on the back end. </p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="left">Key</th>
      
<th align="left">Accepted Values</th>
      
<th align="left">Description</th>
      
<th align="left">Notes</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="left"><tt>type</tt></td>
      
<td align="left"><tt>number</tt></td>
      
<td align="left">for any integer or decimal</td>
      
<td align="left">optional</td>
    </tr>
    
<tr class="a">
      
<td align="left"> </td>
      
<td align="left"><tt>text</tt></td>
      
<td align="left">for case-insensitive text, will apply the <tt>LOWER()</tt> function</td>
      
<td align="left">optional</td>
    </tr>
    
<tr class="b">
      
<td align="left"> </td>
      
<td align="left"><tt>etxt</tt></td>
      
<td align="left">for case-sensitive text</td>
      
<td align="left">optional</td>
    </tr>
  </tbody>
</table></div></div>
<div class="section">
<h2>Examples<a name="Examples"></a></h2>
<p>The following example shows a filter which should return values where: <tt>f1 = 'v1' AND ( (f2 &lt; 6 OR f3 &gt;= 100) AND (f4 &gt; 0.5 OR f5 is not null) )</tt></p>

<div class="source">
<pre>{&quot;groupOp&quot;:&quot;AND&quot;,
 &quot;rules&quot;:[{&quot;field&quot;:&quot;f1&quot;,&quot;op&quot;:&quot;eq&quot;,&quot;data&quot;:&quot;v1&quot;,&quot;type&quot;:&quot;text&quot;}],
 &quot;groups&quot;:[{&quot;groupOp&quot;:&quot;OR&quot;,
              &quot;rules&quot;:[{&quot;field&quot;:&quot;f2&quot;,&quot;op&quot;:&quot;lt&quot;,&quot;data&quot;:&quot;6&quot;,&quot;type&quot;: &quot;number&quot;},
                       {&quot;field&quot;:&quot;f3&quot;,&quot;op&quot;:&quot;ge&quot;,&quot;data&quot;:&quot;100&quot;,&quot;type&quot;: &quot;number&quot;}],
             &quot;groups&quot;:[]},
           {&quot;groupOp&quot;:&quot;OR&quot;,
              &quot;rules&quot;:[{&quot;field&quot;:&quot;f4&quot;,&quot;op&quot;:&quot;gt&quot;,&quot;data&quot;:&quot;0.5&quot;, &quot;type&quot;: &quot;number&quot;},
                       {&quot;field&quot;:&quot;f5&quot;,&quot;op&quot;:&quot;nn&quot;,&quot;data&quot;:&quot;&quot;}],
             &quot;groups&quot;:[]}]}
</pre></div>
<p>It may be easier to think it terms of <a class="externalLink" href="http://en.wikipedia.org/wiki/Polish_notation">Polish or Prefix Notation</a>: <tt>AND  f1='v1' (OR (&lt; f 26) (&gt;= f3 100)) (OR (&gt;f4 0.5) not(is null(f5)))</tt> &#x2026;or not </p></div>
<div class="section">
<h2>Javascript Example<a name="Javascript_Example"></a></h2>

<div class="source">
<pre>var filter={
             &quot;groupOp&quot;:&quot;AND&quot;,
             &quot;rules&quot;: [
                       { 
                         &quot;field&quot;: &quot;GENE_SYMBOL&quot;, 
                         &quot;op&quot;   : &quot;in&quot;, 
                         &quot;data&quot; : &quot;ABL1,EGFR&quot; 
                       },
                       { 
                         &quot;field&quot;: &quot;SAMPLE_TYPE&quot;, 
                         &quot;op&quot;   : &quot;eq&quot;, 
                         &quot;data&quot; : &quot;Cell Line&quot;, 
                         &quot;type&quot; : &quot;etxt&quot;
                       }
                      ]
           };
$.ajax({  
  &quot;url&quot;:...,  
  &quot;data&quot;:{  
    &quot;qname&quot;:...,  
    &quot;filters&quot;:JSON.stringify(filter)
  }
});
</pre></div></div>
<div class="section">
<h2>Behind the scenes<a name="Behind_the_scenes"></a></h2>
<p><tt>JDBCAdaptor.getQueryFilters()</tt> used constants, but here is a version of the method using string literals to illustrate the mechanism:</p>

<div class="source">
<pre>   // nulls, not nulls
        if(op.matches(&quot;nu|nn&quot;))
        {
            sql.append(SQL_CORE_ALIAS+&quot;.&quot; + field + &quot; &quot;);
            sql.append(&quot;IS &quot;);
            if (&quot;nn&quot;.equals(op))  {  sql.append(&quot;NOT &quot;); }
            sql.append(&quot;NULL&quot;);
        }
        // numbers
        else
        {
            // strings:  eq, ne, cn, nc, bw, bn, ew, en, in, ni
            // numbers:  eq, ne, lt, le, gt, ge, in, ni
            if (&quot;number&quot;.equals(type))
            {
                sql.append(SQL_CORE_ALIAS+&quot;.&quot; + field + &quot; &quot;);
                if(&quot;ne&quot;.equals(op))            {  sql.append(&quot;&lt;&gt;&quot;);  }
                else if(op.matches(&quot;lt|le&quot;))   {  sql.append(&quot;&lt;&quot;);   }
                else if(op.matches(&quot;gt|ge&quot;))   {  sql.append(&quot;&gt;&quot;);   }
                if(op.matches(&quot;eq|le|ge&quot;))     {  sql.append(&quot;=&quot;);   }
                if(&quot;ni&quot;.matches(op))           {  sql.append(&quot;NOT&quot;); }
                sql.append(&quot; &quot;);
                if(op.matches(&quot;in|ni&quot;))        {  sql.append(&quot;IN (&quot;+value+&quot;) &quot;); }
                else                           {  sql.append(value);  }
            }
 
            // varchars
            else if (&quot;text&quot;.equals(type) | | (&quot;etxt&quot;.equals(type)))
            {
                // case sensitive
                if (&quot;etxt&quot;.equals(type))
                {
                    sql.append(SQL_CORE_ALIAS+&quot;.&quot; + field + &quot; &quot;);
                }
 
                // case insensitive
                else
                {
                    sql.append(&quot;LOWER(&quot;+SQL_CORE_ALIAS+&quot;.&quot; + field + &quot;) &quot;);
                }
 
                if(&quot;eq&quot;.equals(op))            {  sql.append(&quot; = &quot;); }
                else if(&quot;ne&quot;.equals(op))       {  sql.append(&quot; &lt;&gt; &quot;);}
 
                // not contains, not begins with, not ends with
                if(op.matches(&quot;nc|bn|en|ni&quot;))  {  sql.append(&quot;NOT &quot;);}
                if (op.matches(&quot;cn|bw|ew&quot;))  {  sql.append(&quot;LIKE &quot;); }
 
                // equals, not equals, contains,
                if (op.matches(&quot;eq|ne|cn|nc|bw|bn|ew|en&quot;)) {  sql.append(&quot;'&quot;);     }
 
                // contains, ends with, not ends with
                if (op.matches(&quot;cn|ew|en&quot;))    {  sql.append(&quot;%&quot;);   }
                if (op.matches(&quot;eq|ne|cn|nc|bw|bn|ew|en&quot;)) { sql.append(value);  } // value already lower case
                 
                // in, ni
                else
                {
                    String[] split = value.split(&quot;,&quot;);
                    sql.append(&quot;IN (&quot;);
                    for (int j=0;j&lt;split.length;j++)
                    {
                        sql.append(&quot;'&quot;+split[j]+&quot;'&quot;);
                        if (j&lt;split.length-1)
                        {
                            sql.append(&quot;,&quot;);
                        }
                    }
                    sql.append(&quot;)&quot;);
                }
                 
                // contains, begins with, not begins with
                if (op.matches(&quot;cn|bw|bn&quot;))                {  sql.append(&quot;%&quot;); }
                if (op.matches(&quot;eq|ne|cn|nc|bw|bn|ew|en&quot;)) {  sql.append(&quot;'&quot;); }
             
            } // end &quot;text&quot;
        } // end &quot;non null ops
    } // end rules iteration
} // end is rules null  
</pre></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2016
                        <a href="http://opensource.nibr.com">Novartis Institutes for BioMedical Research, Inc</a>.
                  
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
